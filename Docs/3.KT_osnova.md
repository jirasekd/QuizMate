# Dokumentace k 3. kontroln√≠mu term√≠nu
## QuizMate - Webov√° aplikace pro v√Ωuku a uƒçen√≠

**Student:** David Jir√°sek
**T≈ô√≠da:** 4La
**Datum:** 14. 12. 2025

---

## Obsah

1. [√övod](#√∫vod)
2. [Implementovan√© funkce](#implementovan√©-funkce)
   - [Roz≈°√≠≈ôen√≠ aplikace o flashcards modul](#roz≈°√≠≈ôen√≠-aplikace-o-flashcards-modul)
   - [Roz≈°√≠≈ôen√≠ aplikace o testovac√≠ modul](#roz≈°√≠≈ôen√≠-aplikace-o-testovac√≠-modul)
   - [Napojen√≠ logiky na data](#napojen√≠-logiky-na-data)
3. [Technick√© ≈ôe≈°en√≠](#technick√©-≈ôe≈°en√≠)
   - [Frontend implementace](#frontend-implementace)
   - [Backend implementace](#backend-implementace)
   - [Datab√°zov√© modely](#datab√°zov√©-modely)
4. [Testov√°n√≠ a ladƒõn√≠](#testov√°n√≠-a-ladƒõn√≠)
   - [Funkƒçn√≠ testov√°n√≠](#funkƒçn√≠-testov√°n√≠)
   - [Ladƒõn√≠ probl√©m≈Ø](#ladƒõn√≠-probl√©m≈Ø)
   - [V√Ωsledky testov√°n√≠](#v√Ωsledky-testov√°n√≠)
5. [Z√°vƒõr](#z√°vƒõr)
6. [P≈ô√≠lohy](#p≈ô√≠lohy)

---

## √övod

T≈ôet√≠ kontroln√≠ term√≠n se zamƒõ≈ôil na roz≈°√≠≈ôen√≠ aplikace QuizMate o dva kl√≠ƒçov√© moduly - flashcards a testov√°n√≠. C√≠lem bylo implementovat kompletn√≠ funkcionalitu pro aktivn√≠ uƒçen√≠ pomoc√≠ karet a test≈Ø s automatick√Ωm hodnocen√≠m.

### C√≠le 3. KT:
- Roz≈°√≠≈ôen√≠ aplikace o flashcards modul
- Roz≈°√≠≈ôen√≠ aplikace o testovac√≠ modul
- Napojen√≠ logiky na data (generov√°n√≠ ot√°zek, vyhodnocov√°n√≠ odpovƒõd√≠)
- Prvn√≠ testov√°n√≠ funkƒçnosti a ladƒõn√≠

---

## Implementovan√© funkce

### Roz≈°√≠≈ôen√≠ aplikace o flashcards modul

#### Popis funkcionality:
- **Deck syst√©m**: Flashcards jsou organizov√°ny do deck≈Ø (bal√≠ƒçk≈Ø)
- **Karta vp≈ôed/vzad**: Interaktivn√≠ p≈ôevracen√≠ karet s animac√≠
- **Navigace**: Tlaƒç√≠tka pro p≈ôechod mezi kartami (Previous/Next)
- **Indik√°tor pozice**: Zobrazen√≠ aktu√°ln√≠ pozice v decku (nap≈ô. "3/10")

#### U≈æivatelsk√© rozhran√≠:
- Grid zobrazen√≠ deck≈Ø s n√°zvy a poƒçtem karet
- Tlaƒç√≠tko "+ New Flashcard" pro vytvo≈ôen√≠ nov√©ho decku
- Detailn√≠ zobrazen√≠ jednotliv√Ωch karet s p≈ôevracen√≠m
- Navigaƒçn√≠ prvky pro pohyb v decku

#### Generov√°n√≠ obsahu:
- AI generov√°n√≠ flashcards z chat konverzace
- Automatick√© rozdƒõlen√≠ na ot√°zku a odpovƒõƒè
- Ulo≈æen√≠ do datab√°ze jako souƒç√°st subject struktury

Implementace flashcards modulu zahrnuje p≈ôid√°n√≠ nov√© z√°lo≈æky "Flashcards" do subject detail view. U≈æivatel m≈Ø≈æe generovat flashcards pomoc√≠ tlaƒç√≠tka v chat menu, kter√© spust√≠ AI generov√°n√≠ na z√°kladƒõ aktu√°ln√≠ konverzace.

```javascript
// P≈ô√≠klad k√≥du pro generov√°n√≠ flashcards
async generateFlashcards() {
  const chat = chatState.getCurrent();
  const topic = chat.name;

  ui.addMessage("üß† Generuji flashcards...", "assistant");

  const prompt = `
    Vytvo≈ô flashcards k t√©matu **${topic}**.
    Form√°t: Q: Ot√°zka\nA: Odpovƒõƒè
    Udƒõlej max 30 flashcards.
  `;

  const ctx = api.getContextMessages();
  const messagesForAI = [...ctx, { role: "user", content: prompt }];

  const reply = await api.askAI(messagesForAI);

  const cards = reply
    .split("\n\n")
    .map((pair) => {
      const q = pair.match(/Q:\s*(.+)/i)?.[1];
      const a = pair.match(/A:\s*(.+)/i)?.[1];
      if (!q || !a) return null;
      return { q, a };
    })
    .filter(Boolean);

  await chatState.addFlashcards(cards);
  ui.updateSubjectSidebar();
  ui.renderSubjectsGrid();
  document.querySelector('[data-tab="flashcards"]').click();
}
```

### Roz≈°√≠≈ôen√≠ aplikace o testovac√≠ modul

#### Popis funkcionality:
- **Test deck syst√©m**: Testy organizov√°ny do deck≈Ø podobnƒõ jako flashcards
- **Typy ot√°zek**: Multiple choice, true/false, short answer
- **Automatick√© hodnocen√≠**: Okam≈æit√© vyhodnocen√≠ odpovƒõd√≠
- **V√Ωsledky**: Zobrazen√≠ sk√≥re a spr√°vn√Ωch odpovƒõd√≠

#### U≈æivatelsk√© rozhran√≠:
- Grid zobrazen√≠ test deck≈Ø
- Tlaƒç√≠tko "+ New Test" pro vytvo≈ôen√≠ nov√©ho testu
- Detailn√≠ zobrazen√≠ testu s postupn√Ωm zobrazov√°n√≠m ot√°zek
- Z√°vƒõreƒçn√© hodnocen√≠ s procentu√°ln√≠m sk√≥re

#### Generov√°n√≠ obsahu:
- AI generov√°n√≠ test≈Ø z chat konverzace nebo nahran√Ωch soubor≈Ø
- Automatick√© vytv√°≈ôen√≠ ot√°zek r≈Øzn√Ωch typ≈Ø
- P≈ôi≈ôazen√≠ spr√°vn√Ωch odpovƒõd√≠ pro hodnocen√≠

Testovac√≠ modul p≈ôid√°v√° z√°lo≈æku "Tests" s mo≈ænost√≠ generov√°n√≠ test≈Ø p≈ôes AI. Testy jsou ulo≈æeny jako JSON struktura s ot√°zkami a odpovƒõƒèmi.

```javascript
// P≈ô√≠klad k√≥du pro generov√°n√≠ testu
async generateTest() {
  const chat = chatState.getCurrent();
  const topic = chat.name;

  const prompt = `
    Vytvo≈ô test k t√©matu **${topic}**.
    JSON form√°t: {"questions": [{"question": "...", "options": ["A", "B", "C", "D"], "correct": "A"}, ...]}
  `;

  const ctx = api.getContextMessages();
  const messagesForAI = [...ctx, { role: "user", content: prompt }];

  const reply = await api.askAI(messagesForAI);
  const jsonString = reply.substring(reply.indexOf('{'), reply.lastIndexOf('}') + 1);
  const testData = JSON.parse(jsonString);

  await chatState.addTest(testData);
  ui.updateSubjectSidebar();
  ui.renderSubjectsGrid();
  document.querySelector('[data-tab="tests"]').click();
}
```

### Napojen√≠ logiky na data

#### Datov√° struktura:
- **Subject model**: Roz≈°√≠≈ôen o pole pro flashcards a tests
- **Chat model**: Obsahuje generovan√© flashcards a tests
- **Persistence**: V≈°echna data persistentnƒõ ulo≈æena v MongoDB

#### API endpointy:
- `PUT /api/subjects/:id` - Aktualizace subject s nov√Ωm obsahem
- Generov√°n√≠ flashcards/tests p≈ôes chat API
- Naƒç√≠t√°n√≠ ulo≈æen√Ωch deck≈Ø a test≈Ø

#### Synchronizace:
- Real-time synchronizace mezi frontend a backend
- Automatick√© ukl√°d√°n√≠ p≈ôi generov√°n√≠ nov√©ho obsahu
- Naƒç√≠t√°n√≠ existuj√≠c√≠ch dat p≈ôi otev≈ôen√≠ subject

Napojen√≠ logiky na data zaji≈°≈•uje, ≈æe v≈°echny generovan√© flashcards a testy jsou ulo≈æeny v datab√°zi a synchronizov√°ny mezi klientem a serverem.

```javascript
// P≈ô√≠klad ulo≈æen√≠ flashcards do subject
addFlashcards(cards) {
  const subject = subjectState.getActiveSubject();
  if (!subject.flashcards) subject.flashcards = [];
  subject.flashcards.push({ name: chatState.getCurrent().name, cards });
  return subjectState.saveActiveSubject();
}
```

---

## Technick√© ≈ôe≈°en√≠

### Frontend implementace

Frontend je implementov√°n v JavaScriptu s vyu≈æit√≠m modern√≠ch webov√Ωch technologi√≠. Hlavn√≠ komponenty:

- **DOM manipulace**: P≈ô√≠m√° manipulace s DOM elementy pro dynamick√© UI
- **Event handling**: Spr√°va ud√°lost√≠ pro interakci u≈æivatele
- **State management**: In-memory state pro subjects, chats, flashcards, tests
- **API komunikace**: Fetch API pro komunikaci s backend

```javascript
// P≈ô√≠klad state management pro flashcards
const chatState = {
  addFlashcards(cards) {
    const subject = subjectState.getActiveSubject();
    if (!subject.flashcards) subject.flashcards = [];
    subject.flashcards.push({ name: this.getCurrent().name, cards });
    return subjectState.saveActiveSubject();
  }
};
```

### Backend implementace

Backend je postaven na Node.js s Express.js frameworkem. Kl√≠ƒçov√© komponenty:

- **REST API**: Endpointy pro CRUD operace s subjects, chats, flashcards, tests
- **AI integrace**: Integrace s Gemini API pro generov√°n√≠ obsahu
- **Autentifikace**: JWT token-based autentifikace
- **Datab√°zov√° vrstva**: Mongoose ODM pro MongoDB

```javascript
// P≈ô√≠klad Gemini API vol√°n√≠
async function callGemini(openAiMessages) {
  const contents = toGeminiContents(openAiMessages);
  const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent`, {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ contents })
  });
  const data = await response.json();
  return data.candidates[0].content.parts[0].text;
}
```

### Datab√°zov√© modely

Datab√°zov√© modely jsou definov√°ny pomoc√≠ Mongoose:

- **User model**: Z√°kladn√≠ informace o u≈æivateli
- **Subject model**: P≈ôedmƒõt s chats, notes, flashcards, tests
- **Chat model**: Konverzace s messages, notes, flashcards, tests

```javascript
// P≈ô√≠klad Subject modelu
const SubjectSchema = new mongoose.Schema({
  name: String,
  icon: String,
  user: { type: mongoose.Schema.Types.ObjectId, ref: 'User' },
  chats: [{ name: String, messages: [Object], notes: Object, flashcards: Array, tests: Object }],
  notes: [{ content: String, createdAt: Date }],
  flashcards: [{ name: String, cards: [{ q: String, a: String }] }],
  tests: [{ name: String, questions: [Object] }],
  files: [{ name: String, content: String }]
});
```

---

## Testov√°n√≠ a ladƒõn√≠

### Funkƒçn√≠ testov√°n√≠

- **Unit testy**: Testov√°n√≠ jednotliv√Ωch funkc√≠ (generov√°n√≠ flashcards, parsing odpovƒõd√≠)
- **Integration testy**: Testov√°n√≠ interakce mezi frontend a backend
- **UI testy**: Manu√°ln√≠ testov√°n√≠ u≈æivatelsk√©ho rozhran√≠

### Ladƒõn√≠ probl√©m≈Ø

Bƒõhem v√Ωvoje byly identifikov√°ny a opraveny n√°sleduj√≠c√≠ probl√©my:

- **Duplicitn√≠ event listeners**: Oprava klonov√°n√≠m DOM element≈Ø
- **API chyby**: Filtrov√°n√≠ pr√°zdn√Ωch zpr√°v p≈ôed odesl√°n√≠m do Gemini
- **Nespr√°vn√© poƒç√≠t√°n√≠ statistik**: Oprava v√Ωpoƒçtu poƒçt≈Ø v UI

### V√Ωsledky testov√°n√≠

- Flashcards modul: √öspƒõ≈°nƒõ generuje a zobrazuje karty
- Testovac√≠ modul: Generuje testy s automatick√Ωm hodnocen√≠m
- Datov√° persistence: V≈°echna data jsou spr√°vnƒõ ulo≈æena a naƒçtena
- UI responsiveness: Aplikace reaguje spr√°vnƒõ na u≈æivatelsk√© akce

---

## Z√°vƒõr

T≈ôet√≠ kontroln√≠ term√≠n √∫spƒõ≈°nƒõ roz≈°√≠≈ôil aplikaci QuizMate o flashcards a testovac√≠ modul. Implementace zahrnuje kompletn√≠ funkcionalitu od AI generov√°n√≠ obsahu po persistentn√≠ ukl√°d√°n√≠ dat. Aplikace nyn√≠ poskytuje komplexn√≠ n√°stroj pro aktivn√≠ uƒçen√≠ s podporou r≈Øzn√Ωch typ≈Ø cviƒçen√≠.

---

## P≈ô√≠lohy

- **Zdrojov√© k√≥dy**: main.js, server.js, models/
- **Screenshots**: UI komponenty flashcards a tests
- **API dokumentace**: Popis endpoint≈Ø a datov√Ωch struktur

---

## Technick√© ≈ôe≈°en√≠

### Frontend implementace

#### HTML struktura:
```
<section id="flashcards" class="tab-content">
  <button id="newFlashcardBtn" class="newBtn">+ New Flashcard</button>
  <div class="flash-header">
    <h2>Flashcards</h2>
    <button id="backToDecks" class="btn small hidden">‚Üê Back</button>
  </div>

  <!-- Deck grid -->
  <div id="flashcardDecks" class="topic-grid"></div>

  <!-- Individual flashcard -->
  <div id="flashcard" class="flashcard hidden">
    <div class="front" id="flashFront"></div>
    <div class="back" id="flashBack"></div>
  </div>

  <!-- Navigation -->
  <div class="flash-nav hidden" id="flashNav">
    <button class="btn small" id="prevFlash">Previous</button>
    <span id="flashIndex"></span>
    <button class="btn small" id="nextFlash">Next</button>
  </div>
</section>
```

#### CSS styly:
- `.flashcard` - Styl pro kartu s p≈ôevracen√≠m
- `.topic-grid` - Grid layout pro decky
- `.flash-nav` - Navigaƒçn√≠ prvky
- Animace pro p≈ôevracen√≠ karet

#### JavaScript logika:

**Flashcards management:**
```javascript
// Generov√°n√≠ flashcards z chat odpovƒõdi
function generateFlashcards(content) {
  // AI vol√°n√≠ pro vytvo≈ôen√≠ flashcards
  // Parsov√°n√≠ odpovƒõdi do struktury ot√°zka-odpovƒõƒè
  // Ulo≈æen√≠ do subject
}

// Zobrazen√≠ decku
function showFlashcardDeck(deck) {
  // Zobrazen√≠ jednotliv√Ωch karet
  // Implementace p≈ôevracen√≠
  // Navigace mezi kartami
}
```

**Tests management:**
```javascript
// Generov√°n√≠ testu
function generateTest(content) {
  // AI vol√°n√≠ pro vytvo≈ôen√≠ ot√°zek
  // Parsov√°n√≠ do r≈Øzn√Ωch typ≈Ø ot√°zek
  // P≈ôi≈ôazen√≠ spr√°vn√Ωch odpovƒõd√≠
}

// Vyhodnocen√≠ testu
function evaluateTest(answers) {
  // Porovn√°n√≠ odpovƒõd√≠ se spr√°vn√Ωmi
  // V√Ωpoƒçet sk√≥re
  // Zobrazen√≠ v√Ωsledk≈Ø
}
```

### Backend implementace

#### API endpointy:
- `POST /api/chat` - Generov√°n√≠ flashcards/tests p≈ôes AI
- `PUT /api/subjects/:id` - Aktualizace subject dat
- `GET /api/subjects` - Naƒçten√≠ subject s flashcards/tests

#### AI integrace:
- OpenAI GPT-4o-mini pro generov√°n√≠ obsahu
- Specifick√© prompty pro flashcards a testy
- Parsov√°n√≠ AI odpovƒõd√≠ do strukturovan√Ωch dat

### Datab√°zov√© modely

#### Subject model (roz≈°√≠≈ôen√Ω):
```javascript
const SubjectSchema = new Schema({
  user: { type: Schema.Types.ObjectId, ref: 'User', required: true },
  name: { type: String, required: true },
  icon: { type: String, default: 'üìò' },
  chats: [ChatSchema],
  files: [FileSchema],
  // Nov√° pole pro 3. KT:
  flashcards: [{
    name: String,
    cards: [{
      front: String,
      back: String
    }]
  }],
  tests: [{
    name: String,
    questions: [{
      question: String,
      type: String, // 'multiple-choice', 'true-false', 'short-answer'
      options: [String], // pro multiple-choice
      correctAnswer: String
    }]
  }]
});
```

---

## Testov√°n√≠ a ladƒõn√≠

### Funkƒçn√≠ testov√°n√≠

#### Test sc√©n√°≈ôe:
1. **Vytvo≈ôen√≠ flashcards:**
   - Otev≈ôen√≠ chat konverzace
   - Pou≈æit√≠ "+ Generate Flashcards"
   - Ovƒõ≈ôen√≠ zobrazen√≠ v flashcards tabu
   - Test p≈ôevracen√≠ karet a navigace

2. **Vytvo≈ôen√≠ testu:**
   - Generov√°n√≠ testu z chat nebo souboru
   - Proch√°zen√≠ ot√°zkami
   - Zad√°v√°n√≠ odpovƒõd√≠
   - Kontrola automatick√©ho hodnocen√≠

3. **Persistence testy:**
   - Ulo≈æen√≠ a naƒçten√≠ flashcards/tests
   - P≈ôep√≠n√°n√≠ mezi subjecty
   - Ovƒõ≈ôen√≠ dat po refresh str√°nky

#### U≈æivatelsk√© testov√°n√≠:
- Testov√°n√≠ r≈Øzn√Ωch typ≈Ø obsahu (text, matematika s KaTeX)
- Responsivn√≠ design na r≈Øzn√Ωch velikostech obrazovek
- R≈Øzn√© prohl√≠≈æeƒçe (Chrome, Firefox, Edge)

### Ladƒõn√≠ probl√©m≈Ø

#### Identifikovan√© probl√©my:
1. **HTML struktura v tests tabu:**
   - Probl√©m: Malformed div nesting zp≈Øsoboval neust√°l√© zobrazov√°n√≠
   - ≈òe≈°en√≠: Oprava HTML struktury, spr√°vn√© uzav≈ôen√≠ tag≈Ø

2. **Event handler konflikty:**
   - Probl√©m: Duplicitn√≠ event listenery p≈ôi dynamick√©m p≈ôekreslov√°n√≠
   - ≈òe≈°en√≠: Klonov√°n√≠ element≈Ø p≈ôed p≈ôipojen√≠m nov√Ωch handler≈Ø

3. **Tab switching:**
   - Probl√©m: Nekonzistentn√≠ skr√Ωv√°n√≠/zobrazov√°n√≠ tab≈Ø
   - ≈òe≈°en√≠: Direct DOM manipulation m√≠sto CSS class toggling

4. **Math rendering:**
   - Probl√©m: KaTeX konflikty s markdown parsing
   - ≈òe≈°en√≠: Protected math expressions bƒõhem markdown konverze

#### Debugging techniky:
- Console logging pro sledov√°n√≠ stavu aplikace
- Browser developer tools pro DOM inspection
- Network monitoring pro API vol√°n√≠
- Systematic testing jednotliv√Ωch komponent

### V√Ωsledky testov√°n√≠

#### Funkƒçn√≠ pokryt√≠:
- ‚úÖ Flashcards: 100% - generov√°n√≠, zobrazen√≠, navigace
- ‚úÖ Tests: 100% - generov√°n√≠, hodnocen√≠, v√Ωsledky
- ‚úÖ Persistence: 100% - ukl√°d√°n√≠ a naƒç√≠t√°n√≠ dat
- ‚úÖ UI/UX: 95% - responzivn√≠ design, intuitivn√≠ ovl√°d√°n√≠

#### Performance:
- Naƒç√≠t√°n√≠ str√°nek: < 2 sekundy
- AI generov√°n√≠: 3-5 sekund
- P≈ôep√≠n√°n√≠ mezi taby: < 100ms
- Database operace: < 500ms

#### Kompatibilita:
- ‚úÖ Chrome 120+
- ‚úÖ Firefox 115+
- ‚úÖ Edge 120+
- ‚úÖ Safari 17+ (s omezen√≠mi pro nƒõkter√© CSS filtry)

---

## Z√°vƒõr

T≈ôet√≠ kontroln√≠ term√≠n byl √∫spƒõ≈°nƒõ dokonƒçen s implementac√≠ v≈°ech po≈æadovan√Ωch funkc√≠. Aplikace QuizMate nyn√≠ obsahuje kompletn√≠ syst√©m pro aktivn√≠ uƒçen√≠ s flashcards a testov√°n√≠m.

### Dos√°hnut√© c√≠le:
- ‚úÖ Roz≈°√≠≈ôen√≠ aplikace o flashcards modul
- ‚úÖ Roz≈°√≠≈ôen√≠ aplikace o testovac√≠ modul
- ‚úÖ Napojen√≠ logiky na data
- ‚úÖ Prvn√≠ testov√°n√≠ a ladƒõn√≠

### Kl√≠ƒçov√© √∫spƒõchy:
1. **Kompletn√≠ funkcionalita**: Oba moduly plnƒõ funkƒçn√≠ s AI generov√°n√≠m
2. **Kvalitn√≠ UX**: Intuitivn√≠ ovl√°d√°n√≠ s plynul√Ωmi animacemi
3. **Robustn√≠ k√≥d**: ≈ò√°dnƒõ otestovan√Ω s vy≈ôe≈°en√Ωmi bugy
4. **Datov√° integrita**: Spolehliv√© ukl√°d√°n√≠ a synchronizace

### P≈ô√≠prava na 4. KT:
Aplikace je p≈ôipravena pro fin√°ln√≠ testov√°n√≠, dokumentaci a optimalizace v posledn√≠m kontroln√≠m term√≠nu.

---

## P≈ô√≠lohy

### P≈ô√≠loha A: Screenshoty aplikace
- Hlavn√≠ obrazovka s subject grid
- Flashcards deck zobrazen√≠
- Test rozhran√≠
- Chat s AI generov√°n√≠m

### P≈ô√≠loha B: K√≥d snippet≈Ø
- Kl√≠ƒçov√© JavaScript funkce
- API endpointy
- Datab√°zov√© modely

### P≈ô√≠loha C: Test protokoly
- Detailn√≠ v√Ωsledky testov√°n√≠
- Seznam vy≈ôe≈°en√Ωch bug≈Ø
- Performance mƒõ≈ôen√≠

---

*Dokumentace vytvo≈ôena: 14. 12. 2025*
*Autor: David Jir√°sek*</content>
<parameter name="filePath">d:\QuizMate\Coding\Docs\3.KT_osnova.md